{% extends "layout.html" %}

{% block content %}
    <!-- Metrics main content -->
    <div style="flex:1; padding:2rem; font-size:1.2rem;">
        {% if author %}
        <div class="profile-card" style="max-width:400px; margin:auto; background:#fff; border-radius:10px; box-shadow:0 2px 12px rgba(0,0,0,0.08); padding:2rem 2.2rem 1.5rem 2.2rem;">
            <div class="profile-avatar" style="width:60px; height:60px; background:#25D366; color:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:2em; font-weight:bold; margin:auto;">{{ author.name[0] }}</div>
            <h2 style="text-align:center; margin:1rem 0 0.5rem 0;">{{ author.name }}</h2>
                        <div style="text-align:center; margin-bottom:1.2rem;">
                                <div style="display:inline-block;">
                                    <label class="switch">
                                        <input type="checkbox" id="toggle-metric-view">
                                        <span class="slider"></span>
                                    </label>
                                    <span id="toggle-label-left" style="margin-left:0.7em; margin-right:0.7em; font-weight:bold; color:#25D366;">Pro Nachricht</span>
                                    <span id="toggle-label-right" style="margin-left:0.7em; margin-right:0.7em; font-weight:bold; color:#888;">Pro 100 Wörter</span>
                                </div>
                        </div>
            <div id="metrics-per-message">
                <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">
                    Fehlerrate: <strong>{{ author.get_error_rate_per_message() }}</strong> Fehler pro Nachricht
                </div>
                <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">
                    Emoji-Rate: <strong>{{ author.get_emoji_rate_per_message() }}</strong> Emojis pro Nachricht
                </div>
            </div>
            <div id="metrics-per-100words" style="display:none;">
                <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">
                    Fehlerrate: <strong>{{ author.get_error_rate_per_100_words() }}</strong> Fehler pro 100 Wörter
                </div>
                <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">
                    Emoji-Rate: <strong>{{ author.get_emoji_rate_per_100_words() }}</strong> Emojis pro 100 Wörter
                </div>
            </div>
            <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">Meistgenutztes Emoji: <strong>{% if author.get_most_used_emoji() %}{{ author.get_most_used_emoji() }}{% else %}Keine Emojis verwendet{% endif %}</strong></div>
            <div style="text-align:center; margin-bottom:1.2rem; color:#888; font-size:1em;">Meistgenutztes Emoji: <strong>{% if author.get_most_used_emoji() %}{{ author.get_most_used_emoji() }}{% else %}Keine Emojis verwendet{% endif %}</strong></div>
        </div>
                <style>
                .switch {
                    position: relative;
                    display: inline-block;
                    width: 48px;
                    height: 28px;
                    vertical-align: middle;
                }
                .switch input {display:none;}
                .slider {
                    position: absolute;
                    cursor: pointer;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background-color: #ccc;
                    transition: .4s;
                    border-radius: 28px;
                }
                .slider:before {
                    position: absolute;
                    content: "";
                    height: 22px;
                    width: 22px;
                    left: 3px;
                    bottom: 3px;
                    background-color: white;
                    transition: .4s;
                    border-radius: 50%;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.12);
                }
                input:checked + .slider {
                    background-color: #25D366;
                }
                input:checked + .slider:before {
                    transform: translateX(20px);
                }
                </style>
                <script>
                const toggleSwitch = document.getElementById('toggle-metric-view');
                const perMsg = document.getElementById('metrics-per-message');
                const per100 = document.getElementById('metrics-per-100words');
                const labelLeft = document.getElementById('toggle-label-left');
                const labelRight = document.getElementById('toggle-label-right');
                function updateToggleUI() {
                    if (!toggleSwitch.checked) {
                        perMsg.style.display = '';
                        per100.style.display = 'none';
                        labelLeft.style.color = '#25D366';
                        labelRight.style.color = '#888';
                    } else {
                        perMsg.style.display = 'none';
                        per100.style.display = '';
                        labelLeft.style.color = '#888';
                        labelRight.style.color = '#25D366';
                    }
                }
                toggleSwitch.addEventListener('change', updateToggleUI);
                updateToggleUI();
                </script>
        {% else %}
        <div style="text-align:center; color:#888; font-size:1.1em; margin-top:2em;">Wähle einen Autor aus der Liste links aus, um Metriken anzuzeigen.</div>
        {% endif %}
    </div>
{% endblock %}