{% extends "layout.html" %}

{% block content %}

{% if author %}
<div class="profile-card">
    <div class="profile-avatar">{{ author.name[0] }}</div>
    <h2>{{ author.name }}</h2>
    <p><strong>Alter:</strong> {{ author.age or "Unbekannt" }}</p>
    <p><strong>Geschlecht:</strong> {{ author.gender or "Nicht angegeben" }}</p>
    <p><strong>Muttersprache:</strong> {{ author.first_language or "Nicht angegeben" }}</p>
    <p><strong>Weitere Sprachen:</strong> {{ author.languages | join(', ') if author.languages else "Keine" }}</p>
    <p><strong>Region:</strong> {{ author.region or "Nicht angegeben" }}</p>
    <p><strong>Beruf:</strong> {{ author.job or "Nicht angegeben" }}</p>
    <p><strong>Anzahl Chats: </strong> {{ author.chat_ids | length }}</p>
  <button id="add-chat-btn" data-author-id="{{ author.id }}" style="margin-top:0.5rem; padding:0.4rem 1rem; background:#0074D9; color:white; border:none; border-radius:4px; cursor:pointer; font-size:1em;">Chat hinzufügen</button>
  <input type="file" id="chat-file-input" accept=".txt" style="display:none;" />
    <div style="margin-top:1.5rem;">
        <label for="annotation-box"><strong>Annotation:</strong></label><br>
        <textarea id="annotation-box" class="annotation-box" rows="3" readonly>{{ author.annotation or '' }}</textarea>
        <div style="font-size:0.9em;color:#888;">(Klick zum Bearbeiten, Enter oder Klick außerhalb speichert)</div>
        <div style="margin-top:1.2em; text-align:center;">
          <a href="{{ url_for('metrics.metrics_author', author_id=author.id) }}">
            <button style="padding:0.5em 1.4em; background:#25D366; color:#fff; border:none; border-radius:4px; font-size:1em; font-weight:bold; cursor:pointer;">Zeige Statistik</button>
          </a>
        </div>
  <!-- JS moved to static/js/profile.js -->
    </div>
</div>
<div id="analysis-progress-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.25); z-index:2000; align-items:center; justify-content:center;">
  <div style="background:#fff; padding:2em; border-radius:10px; box-shadow:0 4px 24px rgba(0,0,0,0.18); min-width:320px; max-width:90vw;">
    <span id="progress-text" style="font-size:1.1em; color:#075E54;"></span>
    <div style="width:100%; background:#eee; border-radius:4px; margin-top:1em;">
      <div id="progress-bar" style="width:0%; height:20px; background:#25D366; border-radius:4px; transition:width 0.3s;"></div>
    </div>
    <span id="progress-eta" style="display:block; margin-top:0.7em; font-size:1em; color:#444;"></span>
  </div>
</div>
{% else %}
    <div class="no-element-selected">
        <p style="text-align: center; margin-top: 40px; color: #777;">
            Wähle einen Autor aus der Liste links aus.
        </p>
    </div>
{% endif %}
{% endblock %}
{% block scripts %}
  <script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}
